---
import MainLayout from "@/components/MainLayout.astro";
import type { GetStaticPaths } from "astro";
import { type CollectionEntry, getCollection } from "astro:content";

export type Props = {
  postItem: CollectionEntry<"blogPosts">;
};
export const getStaticPaths: GetStaticPaths = async () => {
  const entries = await getCollection(
    "blogPosts",
    ({ data: { status } }) => status === "publish"
  );
  return entries.map((postItem) => ({
    params: {
      slug: postItem.slug
    },
    props: {
      postItem
    }
  }));
};
const { postItem } = Astro.props;
const { title, author, pubDate, isAiGenerated } = postItem.data;
const { Content } = await postItem.render();
---

<MainLayout parentClass="p-8">
  <div class="flex flex-col">
    <h1 class="text-4xl font-bold">{title}</h1>
    <div class="my-4">
      <time datetime={pubDate.toISOString()}>{pubDate.toDateString()}</time>
      <span>By {author.slug}</span>
    </div>
    {
      isAiGenerated && (
        <div class="ring rounded ring-red-5 p-2">
          <strong class="!text-red-5">Warning!</strong>
          <span>This post is generated by Ai. Learn more about</span>
          <a
            class="!text-red-5 hover:underline italic"
            href="/pages/ai-generated-content"
          >
            Ai generated content.
          </a>
        </div>
      )
    }
  </div>
  <article class="text-base prose prose-dark dark:prose-light">
    <Content />
  </article>
</MainLayout>
